close all
clear
clc

graphics_toolkit qt;

% Copy of raw data
german_snrs_near = [-15.0 -12.5 -10.0];
german_snrs_mid  = [-13.0 -10.0 -7.0];
german_snrs_far  = [-13.0 -9.0 -5.0];

german_data_near_plain  = [0.2 0.6 0.9; 0.1 0.2 0.7; 0.0 0.4 0.2; 0.0 0.6 0.6; 0.1 0.8 0.7; 0.1 0.6 0.7; 0.3 0.6 0.5; 0.1 0.5 0.5; 0.1 0.3 1.0; 0.7 0.5 1.0; 0.2 0.4 0.8; 0.2 0.7 0.5; 0.1 0.6 0.2; 0.1 0.2 0.6; 0.0 0.3 0.8; 0.2 0.4 0.7; 0.1 0.2 0.4; 0.3 0.7 0.7; 0.0 0.1 0.8; 0.1 0.3 0.3; 0.1 0.1 0.9; 0.1 0.2 0.5; 0.2 0.5 0.5; 0.3 0.4 1.0; 0.3 0.5 0.9; 0.2 0.6 0.7; 0.0 0.1 0.7; 0.0 0.4 0.4; 0.1 0.2 0.6; 0.2 0.4 0.5; 0.1 0.4 0.6; 0.1 0.4 0.4; 0.1 0.2 0.8; 0.2 0.8 0.9; 0.3 0.5 0.7; 0.1 0.5 0.4; 0.1 0.5 0.7; 0.1 0.1 0.7; 0.2 0.1 0.5; 0.0 0.6 0.5; 0.2 0.6 0.7; 0.1 0.4 0.8; 0.2 0.6 0.6; 0.1 0.3 0.7; 0.0 0.2 0.4; 0.1 0.7 0.4; 0.0 0.2 1.0; 0.0 0.1 0.4; 0.2 0.3 1.0; 0.0 0.5 1.0; 0.0 0.8 0.6; 0.0 0.5 0.9; 0.2 0.3 0.7; 0.0 0.6 0.8; 0.2 0.4 0.7; 0.0 0.6 0.8; 0.0 0.4 0.6; 0.0 0.2 0.9; 0.1 0.4 0.4; 0.0 0.2 0.4; 0.2 0.3 0.7; 0.1 0.3 0.6];
german_data_near_proc   = [0.4 0.7 0.6; 0.3 0.5 0.9; 0.9 1.0 0.9; 0.5 0.5 1.0; 0.6 0.9 1.0; 0.5 0.8 0.8; 0.9 1.0 0.8; 0.5 1.0 1.0; 0.7 0.6 1.0; 0.9 0.6 1.0; 0.5 1.0 0.8; 0.4 0.8 0.9; 0.3 0.6 0.9; 0.7 0.9 1.0; 0.9 0.8 0.9; 0.7 0.7 1.0; 0.7 0.9 1.0; 0.9 0.7 0.9; 0.4 0.8 0.4; 0.3 0.7 0.8; 0.7 0.7 0.8; 0.3 0.7 1.0; 0.6 0.8 0.8; 0.7 0.8 1.0; 0.6 0.8 1.0; 0.3 0.5 0.8; 0.4 0.5 1.0; 0.7 0.7 0.7; 0.6 0.5 0.8; 0.6 0.8 0.9; 0.6 0.3 0.8; 0.7 0.5 0.7; 0.5 0.6 0.9; 0.3 0.5 0.6; 0.5 0.8 0.8; 0.7 0.9 0.8; 0.5 0.8 0.8; 0.5 0.6 0.8; 0.2 0.9 1.0; 0.8 0.9 0.7; 0.7 1.0 0.9; 0.6 0.5 0.9; 0.4 0.7 1.0; 0.9 0.7 1.0; 0.3 0.5 0.8; 0.4 0.8 0.3; 0.4 0.8 1.0; 0.3 0.6 0.7; 0.5 0.8 0.8; 0.4 0.9 0.9; 0.5 0.7 1.0; 0.4 0.5 0.9; 0.4 0.7 0.7; 0.5 0.8 1.0; 0.5 0.9 0.8; 0.6 0.7 0.9; 0.7 0.8 0.8; 0.4 0.4 1.0; 0.7 0.4 1.0; 0.9 0.9 0.9; 0.7 0.7 0.6; 0.3 0.7 0.8];
german_data_mid_plain   = [0.0 0.7 0.8; 0.5 0.5 0.5; 0.0 0.3 0.7; 0.2 0.7 0.8; 0.6 0.3 1.0; 0.2 0.7 0.6; 0.1 0.7 0.9; 0.2 0.5 1.0; 0.1 0.3 0.9; 0.3 0.6 0.9; 0.5 0.4 1.0; 0.2 0.6 0.8; 0.2 0.3 0.7; 0.1 0.7 0.8; 0.2 0.5 1.0; 0.3 0.2 0.8; 0.0 0.2 0.5; 0.0 0.5 1.0; 0.1 0.2 0.7; 0.2 0.6 0.8; 0.1 0.3 0.7; 0.0 0.6 0.7; 0.1 0.4 0.5; 0.1 0.5 0.8; 0.0 0.7 0.9; 0.1 0.6 0.7; 0.0 0.4 0.8; 0.1 0.8 0.8; 0.1 0.6 0.7; 0.3 0.7 0.7; 0.0 0.3 0.4; 0.3 0.1 0.8; 0.1 0.0 0.4; 0.3 0.5 1.0; 0.2 0.3 0.8; 0.0 0.8 0.7; 0.1 0.4 0.8; 0.2 0.3 0.5; 0.3 0.3 0.5; 0.5 0.5 0.5; 0.3 0.3 0.6; 0.0 0.4 0.8; 0.1 0.8 0.3; 0.0 0.7 1.0; 0.0 0.3 0.9; 0.0 0.5 0.2; 0.2 0.7 0.9; 0.1 0.0 0.6; 0.5 0.7 1.0; 0.1 0.2 0.6; 0.0 0.4 0.7; 0.0 0.3 0.5; 0.3 0.7 1.0; 0.2 0.5 0.8; 0.2 0.3 0.6; 0.2 0.6 0.2; 0.2 0.2 0.7; 0.0 0.3 0.6; 0.0 0.4 0.3; 0.1 0.3 0.0; 0.2 0.2 0.8; 0.1 0.4 0.8];
german_data_mid_proc    = [0.1 0.6 1.0; 0.6 0.4 0.7; 0.1 0.7 0.9; 0.4 0.8 0.8; 0.1 0.5 1.0; 0.9 0.2 1.0; 0.6 0.7 0.7; 0.7 0.8 0.9; 0.5 0.9 0.8; 0.9 0.7 0.9; 0.3 0.7 0.7; 0.6 0.7 0.8; 0.7 0.7 0.9; 0.6 0.7 1.0; 0.6 0.8 0.9; 0.2 0.6 0.6; 0.4 0.9 0.5; 0.7 0.8 1.0; 0.4 0.8 1.0; 0.3 0.9 0.3; 0.3 0.4 0.4; 0.3 0.3 0.6; 0.5 0.7 0.8; 0.9 0.5 0.5; 0.5 0.8 0.9; 0.2 0.9 0.8; 0.5 0.9 0.9; 0.0 0.8 0.5; 0.3 0.9 0.8; 0.2 0.7 0.6; 0.4 0.7 0.9; 0.6 1.0 0.9; 0.7 0.5 0.9; 0.5 0.8 0.5; 0.4 0.7 0.7; 0.3 0.5 0.7; 0.1 0.6 0.6; 0.7 0.6 0.8; 0.4 0.5 0.9; 0.3 0.8 0.3; 0.7 0.7 0.8; 0.5 0.7 0.8; 0.9 1.0 1.0; 0.7 0.8 0.8; 0.5 0.6 0.9; 0.3 0.4 0.9; 0.8 0.7 0.9; 0.3 0.6 0.7; 0.5 0.6 1.0; 0.2 0.6 0.6; 0.2 0.5 0.9; 0.4 0.5 0.8; 0.3 1.0 1.0; 0.5 0.6 0.6; 0.4 1.0 1.0; 0.2 0.6 0.5; 0.2 0.6 0.7; 0.3 0.6 0.5; 0.5 0.5 0.6; 0.2 0.2 0.6; 0.4 0.5 0.8; 0.3 0.4 1.0];
german_data_far_plain   = [0.1 0.4 0.6; 0.3 0.4 0.8; 0.3 0.3 0.7; 0.1 0.2 0.7; 0.3 0.4 1.0; 0.2 0.4 0.6; 0.1 0.3 0.9; 0.3 0.6 0.7; 0.0 0.1 0.9; 0.2 0.5 1.0; 0.0 0.6 0.6; 0.2 0.6 0.8; 0.1 0.3 0.7; 0.3 0.2 0.3; 0.2 0.8 0.7; 0.3 0.8 0.9; 0.0 0.1 0.8; 0.2 0.8 0.9; 0.0 0.0 0.9; 0.0 0.1 0.8; 0.2 0.2 0.7; 0.1 0.5 0.6; 0.4 0.8 0.8; 0.2 0.9 0.8; 0.0 0.5 0.9; 0.1 0.3 1.0; 0.0 0.3 0.7; 0.2 0.2 0.8; 0.0 0.3 0.5; 0.0 0.5 1.0; 0.0 0.4 0.7; 0.0 0.4 0.8; 0.0 0.5 0.8; 0.3 0.5 0.8; 0.0 0.8 0.9; 0.0 0.7 0.8; 0.0 0.2 0.9; 0.1 0.1 0.8; 0.1 0.4 0.9; 0.0 0.0 0.9; 0.5 0.5 0.9; 0.3 0.3 0.8; 0.1 0.4 0.6; 0.0 0.8 0.6; 0.1 0.2 0.8; 0.1 0.5 0.5; 0.3 0.8 0.9; 0.0 0.1 0.9; 0.0 0.6 0.6; 0.2 0.3 0.7; 0.3 0.7 0.8; 0.0 0.4 0.6; 0.1 0.7 0.7; 0.2 0.3 0.8; 0.1 0.3 0.7; 0.0 0.3 0.9; 0.2 0.1 0.9; 0.0 0.2 0.8; 0.0 0.5 0.9; 0.0 0.1 0.8; 0.0 0.5 0.9; 0.3 0.5 0.3];
german_data_far_proc    = [0.1 0.4 0.7; 0.6 0.7 0.4; 0.1 0.9 1.0; 0.6 0.3 0.8; 0.6 0.4 0.9; 0.3 0.3 0.9; 0.1 0.7 0.9; 0.3 0.6 0.9; 0.2 0.7 0.7; 0.7 0.9 1.0; 0.7 1.0 0.9; 0.0 0.5 0.7; 0.6 0.7 1.0; 0.4 1.0 0.8; 0.2 0.7 0.8; 0.2 0.2 0.8; 0.2 0.5 0.9; 0.2 1.0 0.5; 0.3 0.4 0.6; 0.0 0.4 0.6; 0.0 0.3 0.7; 0.0 0.4 0.4; 0.5 0.3 1.0; 0.5 0.8 1.0; 0.2 0.4 0.9; 0.2 0.4 0.8; 0.0 0.3 0.7; 0.1 0.4 0.9; 0.3 0.3 0.9; 0.3 0.6 0.6; 0.3 0.7 0.8; 0.1 0.5 0.8; 0.8 0.5 0.6; 0.1 0.5 0.9; 0.7 0.3 1.0; 0.2 0.7 0.4; 0.2 0.4 0.6; 0.5 0.1 0.7; 0.8 0.3 0.7; 0.0 0.2 1.0; 0.1 0.4 0.6; 0.3 0.7 0.9; 0.5 0.6 1.0; 0.3 0.7 0.7; 0.5 0.3 0.6; 0.0 0.2 0.7; 0.5 0.5 0.8; 0.5 0.8 0.7; 0.3 0.6 0.9; 0.2 0.7 0.8; 0.6 0.7 0.3; 0.2 0.4 0.8; 0.3 0.7 0.8; 0.3 0.6 0.6; 0.2 0.7 1.0; 0.6 0.8 0.7; 0.4 0.4 0.9; 0.0 0.4 0.8; 0.2 0.9 0.6; 0.3 0.5 0.7; 0.2 0.5 0.4; 0.2 0.4 0.6];

english_snrs_near = [-13.0 -8.5 -4.0];
english_snrs_mid  = [-11.0 -5 1.0];
english_snrs_far  = [-10.0 -4.0 2.0];

english_data_near_plain = [0.0 0.0 0.4; 0.5 0.2 0.7; 0.0 0.1 0.5; 0.0 0.1 0.7; 0.1 0.2 0.4; 0.1 0.4 0.7; 0.0 0.1 0.1; 0.0 0.4 0.7; 0.3 0.3 0.9; 0.0 0.0 1.0; 0.0 0.1 0.6; 0.2 0.3 0.8; 0.2 0.2 0.6; 0.0 0.0 0.3; 0.3 0.2 0.6; 0.2 0.0 0.8; 0.0 0.4 0.7; 0.0 0.0 0.4; 0.0 0.4 0.4; 0.0 0.5 0.9; 0.2 0.2 0.5; 0.0 0.0 0.6; 0.0 0.4 0.6; 0.2 0.3 0.1; 0.0 0.1 0.2; 0.0 0.1 0.5; 0.0 0.3 0.5; 0.0 0.2 0.6; 0.0 0.2 0.4; 0.0 0.1 0.7; 0.2 0.2 0.5; 0.0 0.1 0.9; 0.0 0.0 0.1; 0.0 0.2 0.3; 0.0 0.2 0.7; 0.0 0.1 0.3; 0.0 0.1 0.6; 0.1 0.0 0.4; 0.1 0.1 0.5; 0.0 0.1 0.7; 0.0 0.4 0.5; 0.0 0.0 0.2; 0.4 0.1 0.5; 0.2 0.3 0.4; 0.0 0.5 0.2; 0.0 0.4 0.2; 0.1 0.1 0.5; 0.0 0.2 0.6; 0.3 0.1 0.4; 0.0 0.2 0.4; 0.1 0.3 0.7; 0.0 0.0 0.2; 0.1 0.3 0.5; 0.0 0.4 0.7; 0.2 0.1 0.5; 0.0 0.1 0.5; 0.0 0.0 0.0; 0.0 0.1 0.3; 0.0 0.3 0.7; 0.0 0.0 0.5; 0.0 0.4 0.2; 0.2 0.2 0.7; 0.1 0.2 0.3];
english_data_near_proc  = [0.2 0.2 0.5; 0.1 0.1 0.6; 0.3 0.7 0.8; 0.0 0.2 0.6; 0.0 0.0 0.5; 0.1 0.8 0.7; 0.2 0.2 0.6; 0.1 0.3 0.5; 0.1 0.3 0.6; 0.1 0.4 0.5; 0.0 0.5 0.5; 0.5 0.3 0.9; 0.0 0.0 0.6; 0.0 0.3 0.7; 0.1 0.3 0.6; 0.0 0.4 0.6; 0.0 0.2 0.8; 0.0 0.2 0.5; 0.2 0.7 1.0; 0.1 0.3 0.8; 0.4 0.4 0.5; 0.1 0.3 0.4; 0.1 0.4 0.9; 0.1 0.2 0.4; 0.0 0.0 0.4; 0.1 0.2 0.6; 0.0 0.2 0.5; 0.0 0.4 0.8; 0.0 0.3 0.8; 0.0 0.4 0.6; 0.3 0.2 0.8; 0.1 0.0 1.0; 0.0 0.2 0.7; 0.0 0.2 0.7; 0.0 0.7 0.4; 0.5 0.5 0.5; 0.2 0.3 0.7; 0.0 0.1 0.4; 0.0 0.3 0.3; 0.0 0.0 0.5; 0.0 0.3 0.6; 0.0 0.3 0.6; 0.0 0.8 0.6; 0.2 0.1 0.4; 0.4 0.8 0.8; 0.0 0.4 0.8; 0.3 0.6 0.6; 0.3 0.4 0.2; 0.4 0.2 0.4; 0.0 0.2 0.6; 0.0 0.2 0.7; 0.0 0.1 0.7; 0.1 0.3 0.4; 0.2 0.7 0.7; 0.2 0.4 0.9; 0.0 0.4 0.9; 0.1 0.1 0.1; 0.0 0.4 0.7; 0.1 0.3 0.2; 0.0 0.2 0.7; 0.2 0.4 0.3; 0.0 0.3 0.4; 0.3 0.3 0.2];
english_data_mid_plain  = [0.1 0.4 0.6; 0.4 0.5 0.8; 0.1 0.1 0.5; 0.0 0.5 0.7; 0.2 0.5 0.8; 0.5 0.7 0.8; 0.0 0.0 0.2; 0.1 0.4 0.9; 0.3 0.5 0.6; 0.2 0.6 0.8; 0.1 0.7 0.7; 0.2 0.2 0.9; 0.2 0.5 0.4; 0.1 0.4 0.8; 0.2 0.6 0.6; 0.1 0.4 0.9; 0.2 0.4 0.8; 0.0 0.4 0.4; 0.4 0.5 0.9; 0.1 0.6 0.9; 0.4 0.7 0.7; 0.0 0.6 0.9; 0.0 0.4 0.8; 0.1 0.4 0.9; 0.1 0.3 0.6; 0.2 0.5 0.5; 0.1 0.7 0.6; 0.0 0.6 0.8; 0.0 0.3 0.7; 0.1 0.6 1.0; 0.2 0.1 0.7; 0.1 0.0 0.8; 0.1 0.7 0.8; 0.0 0.5 0.5; 0.1 0.6 0.8; 0.2 0.4 0.8; 0.1 0.3 0.8; 0.0 0.1 0.6; 0.2 0.2 0.8; 0.1 0.2 0.7; 0.0 0.4 0.7; 0.1 0.5 0.9; 0.2 0.3 0.9; 0.1 0.7 0.9; 0.3 0.7 0.8; 0.2 0.5 0.4; 0.1 0.7 0.8; 0.2 0.8 0.8; 0.0 0.5 0.7; 0.0 0.5 0.7; 0.1 0.1 0.7; 0.4 0.5 1.0; 0.1 0.5 0.6; 0.2 0.4 0.7; 0.1 0.8 0.8; 0.1 0.1 0.6; 0.1 0.0 0.2; 0.0 0.4 0.7; 0.2 0.7 0.7; 0.0 0.3 0.9; 0.2 0.3 1.0; 0.0 0.4 0.9; 0.2 0.1 0.4];
english_data_mid_proc   = [0.0 0.5 0.6; 0.5 0.2 0.9; 0.2 0.2 0.4; 0.2 0.7 0.8; 0.0 0.0 1.0; 0.1 0.4 0.9; 0.0 0.4 0.4; 0.0 0.5 0.6; 0.2 0.8 0.7; 0.1 0.6 0.6; 0.1 0.8 0.4; 0.2 0.2 0.8; 0.0 0.9 0.9; 0.3 0.4 0.9; 0.6 0.5 0.9; 0.1 0.4 0.5; 0.1 0.6 0.9; 0.0 0.1 1.0; 0.0 0.3 0.9; 0.7 0.6 0.9; 0.0 0.8 0.7; 0.0 0.6 0.4; 0.2 0.5 0.3; 0.2 0.5 0.8; 0.0 0.3 0.4; 0.3 0.6 0.8; 0.2 0.5 0.6; 0.0 0.1 0.8; 0.0 0.3 0.7; 0.0 0.6 0.5; 0.1 0.7 1.0; 0.0 0.2 0.7; 0.2 0.7 0.5; 0.0 0.8 0.5; 0.3 0.6 0.8; 0.2 0.1 0.6; 0.3 0.7 0.9; 0.1 0.3 0.9; 0.1 0.4 0.6; 0.0 0.5 0.8; 0.2 0.6 0.5; 0.5 0.2 0.9; 0.1 0.8 1.0; 0.3 0.4 0.9; 0.2 0.7 1.0; 0.1 0.3 0.8; 0.2 0.3 0.8; 0.2 0.5 0.5; 0.0 0.4 0.8; 0.5 0.3 0.6; 0.1 0.3 0.6; 0.2 0.1 0.6; 0.2 0.2 0.8; 0.1 0.8 0.6; 0.0 0.4 1.0; 0.1 0.5 0.3; 0.0 0.0 0.2; 0.3 0.7 1.0; 0.3 0.3 1.0; 0.0 0.2 0.7; 0.2 0.6 0.5; 0.0 0.0 0.8; 0.2 0.6 0.5];
english_data_far_plain  = [0.1 0.0 0.4; 0.6 0.9 1.0; 0.3 0.3 0.8; 0.1 0.5 0.6; 0.1 0.5 0.7; 0.5 0.4 0.6; 0.0 0.1 0.7; 0.4 0.5 0.9; 0.5 0.5 0.9; 0.0 0.4 0.8; 0.2 0.5 0.6; 0.2 0.4 0.6; 0.3 0.6 0.9; 0.3 0.5 0.9; 0.3 0.4 0.9; 0.1 0.4 0.9; 0.0 0.0 1.0; 0.0 0.0 0.3; 0.2 0.4 0.9; 0.6 0.7 0.8; 0.2 0.6 0.8; 0.2 0.5 0.7; 0.1 0.6 0.5; 0.0 0.5 0.7; 0.7 0.3 0.6; 0.0 0.5 0.6; 0.0 0.4 0.8; 0.0 0.7 0.8; 0.1 0.4 0.8; 0.0 0.4 0.8; 0.4 0.3 0.7; 0.0 0.2 0.5; 0.3 0.4 0.9; 0.0 0.1 0.5; 0.2 0.3 0.9; 0.1 0.3 0.7; 0.3 0.6 0.8; 0.0 0.2 0.6; 0.0 0.0 0.7; 0.1 0.7 0.6; 0.1 0.5 0.7; 0.0 0.5 0.9; 0.2 0.3 0.6; 0.2 0.6 0.9; 0.4 0.3 1.0; 0.4 0.6 0.9; 0.4 0.4 0.8; 0.5 0.5 0.8; 0.1 0.5 0.9; 0.2 0.6 0.9; 0.0 0.1 0.6; 0.1 0.3 0.8; 0.2 0.5 0.8; 0.2 0.4 0.6; 0.2 0.5 0.8; 0.0 0.7 0.6; 0.0 0.0 0.3; 0.0 0.6 0.9; 0.1 0.4 0.8; 0.1 0.4 0.9; 0.1 0.8 1.0; 0.3 0.1 0.7; 0.1 0.7 0.5];
english_data_far_proc   = [0.1 0.4 0.8; 0.5 0.5 0.8; 0.1 0.2 0.9; 0.0 0.7 0.9; 0.1 0.1 0.5; 0.1 0.5 1.0; 0.0 0.2 0.6; 0.3 0.3 0.6; 0.2 0.7 0.6; 0.0 0.3 0.3; 0.0 0.2 0.7; 0.0 0.6 0.6; 0.4 0.5 0.7; 0.4 0.9 0.9; 0.3 0.4 0.8; 0.2 0.5 0.7; 0.2 0.4 0.4; 0.0 0.0 0.4; 0.0 0.3 0.7; 0.1 0.7 1.0; 0.0 0.7 0.8; 0.3 0.3 0.8; 0.2 0.6 0.6; 0.4 0.2 0.9; 0.2 0.2 0.5; 0.1 0.6 0.9; 0.3 0.7 0.3; 0.0 0.3 0.5; 0.3 0.3 0.3; 0.0 0.4 0.6; 0.1 0.5 0.8; 0.1 0.5 0.7; 0.1 0.3 0.7; 0.0 0.2 0.8; 0.1 0.3 0.9; 0.2 0.3 0.3; 0.2 0.5 0.9; 0.1 0.2 0.3; 0.0 0.5 0.5; 0.0 0.5 0.6; 0.3 0.6 0.6; 0.0 0.2 0.6; 0.0 0.9 0.8; 0.2 0.7 0.7; 0.8 0.8 1.0; 0.2 0.2 0.9; 0.2 0.7 0.6; 0.0 0.4 0.4; 0.1 0.7 0.7; 0.3 0.2 0.6; 0.1 0.4 0.6; 0.0 0.2 1.0; 0.4 0.5 0.3; 0.1 0.2 0.6; 0.0 0.9 1.0; 0.0 0.8 0.3; 0.3 0.0 0.5; 0.0 0.4 0.7; 0.1 0.5 1.0; 0.0 0.0 0.2; 0.3 0.5 0.9; 0.0 0.3 0.9; 0.4 0.6 0.4];

spanish_snrs_near = [-17.5 -14.5 -11.5];
spanish_snrs_mid  = [-17.0 -14.0 -11.0];
spanish_snrs_far  = [-18.0 -14.0 -10.0];

spanish_data_near_plain = [0.0 0.7 0.4; 0.4 0.6 0.7; 0.2 0.4 0.6; 0.0 0.6 0.7; 0.0 0.7 0.4; 0.1 0.5 0.7; 0.4 0.1 0.9; 0.0 0.0 0.8; 0.0 0.5 0.5; 0.1 0.1 0.4; 0.0 0.5 0.4; 0.1 0.5 0.6; 0.1 0.1 0.9; 0.0 0.1 0.9; 0.1 0.6 0.3; 0.0 0.6 0.8; 0.1 0.0 0.3; 0.2 0.9 1.0; 0.3 0.8 0.8; 0.2 0.6 0.9; 0.4 0.6 1.0; 0.0 0.3 0.5; 0.0 0.4 0.2; 0.0 0.6 0.8; 0.1 0.6 0.6; 0.1 0.7 0.7; 0.0 0.1 0.5; 0.0 0.1 0.3; 0.2 0.9 0.8; 0.0 0.0 0.5; 0.0 0.6 0.8; 0.2 0.3 0.9; 0.3 0.9 1.0; 0.2 0.4 0.9; 0.0 0.1 0.8; 0.6 0.9 1.0; 0.2 0.6 0.9; 0.1 0.2 0.8; 0.0 0.2 0.6; 0.0 0.1 0.2; 0.1 0.3 0.3; 0.1 0.6 0.5; 0.2 0.6 0.7; 0.0 0.1 0.5; 0.3 0.1 0.8; 0.5 0.9 0.7; 0.1 0.1 0.4; 0.0 0.0 0.5; 0.1 0.1 0.8; 0.4 0.6 0.9; 0.0 0.2 0.7; 0.0 0.3 0.2; 0.8 0.8 0.9; 0.0 0.8 0.7; 0.2 0.5 0.4; 0.2 0.7 1.0; 0.1 0.0 0.4; 0.1 0.2 0.5; 0.6 0.7 0.8; 0.0 0.1 0.5; 0.0 0.4 0.7; 0.4 0.6 0.8];
spanish_data_near_proc  = [0.7 1.0 1.0; 0.8 0.9 1.0; 0.8 0.7 1.0; 0.7 0.8 0.9; 0.5 0.9 0.9; 0.3 0.7 0.8; 0.1 0.8 0.8; 0.4 0.8 1.0; 0.8 0.8 0.9; 0.3 0.7 0.6; 0.7 1.0 0.7; 0.9 0.8 1.0; 0.7 0.8 1.0; 0.4 0.9 1.0; 0.8 0.9 1.0; 0.7 0.6 1.0; 0.4 0.5 1.0; 0.9 1.0 0.7; 0.6 1.0 0.9; 0.9 0.7 1.0; 0.7 0.8 0.6; 0.8 0.9 0.9; 0.6 0.8 0.9; 0.4 0.9 1.0; 0.7 0.6 0.7; 0.2 0.8 0.7; 0.5 0.6 0.6; 0.7 0.9 0.7; 0.8 0.9 1.0; 0.5 1.0 0.8; 0.6 0.2 0.8; 0.4 0.9 1.0; 0.8 0.7 1.0; 0.6 0.4 1.0; 0.4 0.7 1.0; 0.8 0.9 1.0; 0.5 0.7 0.8; 0.5 1.0 0.7; 0.3 0.8 1.0; 0.3 0.9 0.9; 0.3 0.6 0.8; 0.6 1.0 1.0; 0.7 0.7 0.9; 0.3 0.6 0.5; 0.3 0.7 0.9; 0.9 1.0 0.8; 0.5 0.7 1.0; 0.0 0.8 0.8; 0.5 0.7 0.8; 0.5 0.8 1.0; 0.0 0.6 0.7; 0.1 0.2 0.7; 0.7 0.8 0.9; 0.3 0.8 1.0; 0.8 0.8 0.9; 0.6 0.9 0.7; 0.5 0.9 0.9; 0.4 0.8 0.4; 0.9 0.7 0.9; 0.5 0.9 0.9; 0.6 0.6 0.9; 0.5 0.9 0.6];
spanish_data_mid_plain  = [0.5 0.7 0.8; 0.2 0.6 0.7; 0.3 0.6 0.9; 0.0 0.1 0.4; 0.0 0.1 0.4; 0.3 0.5 0.8; 0.1 0.2 0.2; 0.0 0.3 0.5; 0.1 0.0 0.5; 0.0 0.3 0.1; 0.0 0.1 0.2; 0.0 0.6 0.4; 0.2 0.3 0.7; 0.0 0.1 0.3; 0.0 0.0 0.2; 0.5 0.5 0.9; 0.0 0.0 0.2; 0.3 0.4 0.7; 0.4 0.5 0.9; 0.0 0.2 0.7; 0.4 0.2 0.8; 0.0 0.4 0.2; 0.1 0.0 0.1; 0.0 0.2 0.2; 0.3 0.2 0.5; 0.0 0.4 0.6; 0.1 0.2 0.6; 0.0 0.0 0.6; 0.4 0.7 0.7; 0.1 0.0 0.0; 0.0 0.2 0.6; 0.1 0.0 0.7; 0.5 0.3 0.9; 0.0 0.4 0.8; 0.0 0.3 0.3; 0.3 0.7 1.0; 0.1 0.0 0.8; 0.2 0.2 0.1; 0.2 0.0 0.6; 0.0 0.3 0.3; 0.2 0.3 0.5; 0.0 0.0 0.5; 0.0 0.1 0.8; 0.0 0.1 0.9; 0.1 0.3 0.5; 0.0 0.1 0.5; 0.0 0.0 0.0; 0.0 0.0 0.0; 0.1 0.2 0.4; 0.4 0.5 0.5; 0.1 0.0 0.6; 0.1 0.0 0.1; 0.2 0.7 0.7; 0.2 0.0 0.7; 0.0 0.3 0.4; 0.2 0.2 0.7; 0.0 0.2 0.8; 0.0 0.3 0.1; 0.2 0.5 0.8; 0.1 0.5 0.4; 0.1 0.0 0.3; 0.0 0.2 0.5];
spanish_data_mid_proc   = [0.7 1.0 1.0; 0.5 0.9 0.9; 0.9 0.7 0.8; 0.5 0.8 1.0; 0.3 0.7 1.0; 0.4 0.7 0.8; 0.5 0.4 0.5; 0.7 0.4 0.7; 0.4 0.4 0.5; 0.7 0.4 0.8; 0.0 0.8 0.8; 0.5 0.4 0.9; 0.3 0.5 0.9; 0.1 0.9 0.5; 0.7 1.0 0.7; 0.7 0.8 0.7; 0.0 0.7 0.8; 0.8 1.0 0.8; 0.2 0.8 0.6; 0.7 0.6 0.8; 0.6 0.8 0.9; 0.4 0.5 0.8; 0.2 0.5 0.5; 0.3 0.1 0.9; 0.2 0.6 1.0; 0.5 0.1 0.9; 0.7 0.4 0.9; 0.5 0.4 1.0; 0.5 1.0 0.8; 0.3 0.4 0.8; 0.4 0.9 0.8; 0.2 0.5 1.0; 0.7 0.7 0.9; 0.2 0.9 0.8; 0.4 0.7 0.7; 0.6 0.7 0.6; 0.0 0.9 0.9; 0.4 0.4 0.8; 0.5 1.0 0.8; 0.1 0.5 0.5; 0.4 0.9 0.8; 0.1 0.6 0.3; 0.8 0.3 0.8; 0.0 0.4 0.8; 0.4 0.3 0.8; 0.1 0.7 0.6; 0.3 0.4 0.8; 0.0 0.2 0.9; 0.4 0.4 0.5; 0.4 0.3 0.7; 0.7 0.8 1.0; 0.0 0.0 0.3; 0.7 0.8 0.8; 0.3 0.6 0.8; 0.8 0.7 1.0; 0.6 0.8 0.9; 0.6 0.4 0.9; 0.2 0.7 0.5; 0.6 0.7 0.9; 0.3 0.7 0.8; 0.3 0.7 0.6; 0.4 0.7 0.4];
spanish_data_far_plain  = [0.5 0.7 1.0; 0.1 0.4 0.8; 0.0 0.4 0.8; 0.0 0.4 0.7; 0.0 0.4 0.2; 0.0 0.0 0.6; 0.0 0.1 0.5; 0.0 0.4 0.4; 0.0 0.4 0.5; 0.0 0.1 0.4; 0.0 0.0 0.3; 0.0 0.0 0.3; 0.1 0.1 0.5; 0.0 0.3 0.3; 0.0 0.6 0.6; 0.2 0.3 0.7; 0.0 0.0 0.7; 0.2 0.9 1.0; 0.0 0.3 0.4; 0.1 0.5 0.5; 0.2 0.4 0.7; 0.0 0.1 0.8; 0.0 0.1 0.6; 0.1 0.2 0.4; 0.1 0.3 0.8; 0.0 0.4 0.6; 0.0 0.0 0.7; 0.0 0.0 0.4; 0.0 0.6 0.9; 0.0 0.1 0.4; 0.0 0.1 0.3; 0.0 0.1 0.5; 0.1 0.8 0.8; 0.1 0.3 0.6; 0.1 0.5 0.3; 0.2 0.6 0.5; 0.2 0.4 0.8; 0.1 0.0 0.3; 0.0 0.4 0.7; 0.0 0.5 0.0; 0.1 0.1 0.2; 0.1 0.2 0.2; 0.0 0.7 0.9; 0.0 0.1 0.2; 0.0 0.4 0.7; 0.2 0.2 0.3; 0.0 0.2 0.4; 0.0 0.0 0.0; 0.0 0.1 0.5; 0.1 0.2 1.0; 0.0 0.0 0.2; 0.0 0.1 0.6; 0.3 0.6 0.3; 0.0 0.1 1.0; 0.1 0.0 0.9; 0.3 0.3 0.7; 0.0 0.1 0.2; 0.0 0.1 0.8; 0.3 0.4 0.6; 0.1 0.1 0.7; 0.0 0.1 0.3; 0.1 0.3 0.6];
spanish_data_far_proc   = [0.9 1.0 1.0; 0.2 0.7 1.0; 0.2 0.8 0.8; 0.1 0.1 0.6; 0.3 0.9 0.9; 0.3 0.5 0.9; 0.1 0.2 0.7; 0.1 0.5 0.5; 0.0 0.4 0.9; 0.1 0.3 0.9; 0.0 0.2 0.4; 0.1 0.0 0.7; 0.2 0.5 0.8; 0.2 0.3 0.5; 0.0 0.1 0.6; 0.6 0.7 0.5; 0.3 0.3 0.6; 0.4 0.7 1.0; 0.4 0.4 0.7; 0.4 0.4 1.0; 0.3 0.6 0.4; 0.3 0.3 0.6; 0.1 0.2 0.1; 0.5 0.9 0.6; 0.3 0.6 0.7; 0.4 0.7 0.6; 0.1 0.4 0.9; 0.2 0.4 0.9; 0.6 0.5 0.8; 0.3 0.5 0.5; 0.0 0.6 0.9; 0.6 1.0 0.9; 0.5 0.4 1.0; 0.4 0.6 0.9; 0.2 0.2 0.7; 0.8 1.0 1.0; 0.2 0.3 0.2; 0.4 0.5 0.5; 0.0 0.1 0.1; 0.0 0.3 1.0; 0.3 0.3 0.6; 0.0 0.4 0.6; 0.3 0.5 1.0; 0.1 0.0 0.6; 0.0 0.3 0.6; 0.2 0.3 0.7; 0.1 0.1 0.7; 0.0 0.0 0.8; 0.1 0.3 0.3; 0.1 0.5 0.9; 0.1 0.1 0.2; 0.1 0.1 0.4; 0.1 0.6 0.7; 0.2 0.5 0.7; 0.3 0.7 0.6; 0.3 0.3 0.9; 0.1 0.4 0.8; 0.1 0.4 0.4; 0.6 0.5 0.6; 0.1 0.7 0.9; 0.3 0.8 0.8; 0.2 0.8 0.8];

figure('Position', [0 0 300 500]);
colors = lines(3);

subplot(3,1,1);
% German
h = [];
h(end+1) = plot(german_snrs_near,mean(german_data_near_plain).*100,'o--','Color',colors(1,:));
hold on;
h(end+1) = plot(german_snrs_near,mean(german_data_near_proc).*100 ,'x-' ,'Color',colors(1,:));
h(end+1) = plot(german_snrs_mid ,mean(german_data_mid_plain).*100 ,'o--','Color',colors(2,:));
h(end+1) = plot(german_snrs_mid ,mean(german_data_mid_proc).*100  ,'x-' ,'Color',colors(2,:));
h(end+1) = plot(german_snrs_far ,mean(german_data_far_plain).*100 ,'o--','Color',colors(3,:));
h(end+1) = plot(german_snrs_far ,mean(german_data_far_proc).*100  ,'x-' ,'Color',colors(3,:));
xlim([-21 3]);
ylim([0 100]);
xticks(-21:3:3);
yticks(0:10:100);
grid on;
xlabel('Signal-to-noise ratio / dB');
ylabel('Recognition rate / %');
german_near_epsi = epsi(german_snrs_near,mean(german_data_near_proc),1,german_snrs_near,mean(german_data_near_plain),1)
german_mid_epsi  = epsi(german_snrs_mid ,mean(german_data_mid_proc) ,1,german_snrs_mid ,mean(german_data_mid_plain) ,1)
german_far_epsi  = epsi(german_snrs_far ,mean(german_data_far_proc) ,1,german_snrs_far ,mean(german_data_far_plain) ,1)
text(-21,110,sprintf('German: EPSI near=%.1fdB mid=%.1fdB far=%.1fdB', german_near_epsi, german_mid_epsi, german_far_epsi));


% English
subplot(3,1,2);
h = [];
h(end+1) = plot(english_snrs_near,mean(english_data_near_plain).*100,'o--','Color',colors(1,:));
hold on;
h(end+1) = plot(english_snrs_near,mean(english_data_near_proc).*100 ,'x-' ,'Color',colors(1,:));
h(end+1) = plot(english_snrs_mid ,mean(english_data_mid_plain).*100 ,'o--','Color',colors(2,:));
h(end+1) = plot(english_snrs_mid ,mean(english_data_mid_proc).*100  ,'x-' ,'Color',colors(2,:));
h(end+1) = plot(english_snrs_far ,mean(english_data_far_plain).*100 ,'o--','Color',colors(3,:));
h(end+1) = plot(english_snrs_far ,mean(english_data_far_proc).*100  ,'x-' ,'Color',colors(3,:));
xlim([-21 3]);
ylim([0 100]);
xticks(-21:3:3);
yticks(0:10:100);
grid on;
xlabel('Signal-to-noise ratio / dB');
ylabel('Recognition rate / %');
english_near_epsi = epsi(english_snrs_near,mean(english_data_near_proc),1,english_snrs_near,mean(english_data_near_plain),1)
english_mid_epsi  = epsi(english_snrs_mid ,mean(english_data_mid_proc) ,1,english_snrs_mid ,mean(english_data_mid_plain) ,1)
english_far_epsi  = epsi(english_snrs_far ,mean(english_data_far_proc) ,1,english_snrs_far ,mean(english_data_far_plain) ,1)
text(-21,110,sprintf('English: EPSI near=%.1fdB mid=%.1fdB far=%.1fdB', english_near_epsi, english_mid_epsi, english_far_epsi));


% Spanish
subplot(3,1,3);
h = [];
h(end+1) = plot(spanish_snrs_near,mean(spanish_data_near_plain).*100,'o--','Color',colors(1,:));
hold on;
h(end+1) = plot(spanish_snrs_near,mean(spanish_data_near_proc).*100 ,'x-' ,'Color',colors(1,:));
h(end+1) = plot(spanish_snrs_mid ,mean(spanish_data_mid_plain).*100 ,'o--','Color',colors(2,:));
h(end+1) = plot(spanish_snrs_mid ,mean(spanish_data_mid_proc).*100  ,'x-' ,'Color',colors(2,:));
h(end+1) = plot(spanish_snrs_far ,mean(spanish_data_far_plain).*100 ,'o--','Color',colors(3,:));
h(end+1) = plot(spanish_snrs_far ,mean(spanish_data_far_proc).*100  ,'x-' ,'Color',colors(3,:));
xlim([-21 3]);
ylim([0 100]);
xticks(-21:3:3);
yticks(0:10:100);
grid on;
xlabel('Signal-to-noise ratio / dB');
ylabel('Recognition rate / %');
legend(h,{'Near unproc.' 'Near proc.' 'Mid unproc.' 'Mid proc.' 'Far unproc.' 'Far proc.'},'location','east');
spanish_near_epsi = epsi(spanish_snrs_near,mean(spanish_data_near_proc),1,spanish_snrs_near,mean(spanish_data_near_plain),1)
spanish_mid_epsi  = epsi(spanish_snrs_mid ,mean(spanish_data_mid_proc) ,1,spanish_snrs_mid ,mean(spanish_data_mid_plain) ,1)
spanish_far_epsi  = epsi(spanish_snrs_far ,mean(spanish_data_far_proc) ,1,spanish_snrs_far ,mean(spanish_data_far_plain) ,1)
text(-21,110,sprintf('Spanish: EPSI near=%.1fdB mid=%.1fdB far=%.1fdB', spanish_near_epsi, spanish_mid_epsi, spanish_far_epsi));

set(gcf,'PaperUnits','inches','PaperPosition',[0 0 3 5].*1.4);
print('-depsc2','-r300','evaluation.eps');
